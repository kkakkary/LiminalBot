{"version":3,"sources":["../../../../src/lib/structures/ListenerLoaderStrategy.ts"],"names":[],"mappings":";;;AAIO,IAAM,uBAAA,GAAN,MAAM,uBAAA,SAA+B,cAAyB,CAAA;AAAA,EACpD,MAAA,CAAO,QAAuB,KAAiB,EAAA;AAC9D,IAAM,MAAA,gBAAA,GAAmB,MAAM,WAAW,CAAA;AAC1C,IAAA,IAAI,gBAAkB,EAAA;AACrB,MAAA,MAAM,UAAU,KAAM,CAAA,OAAA;AAGtB,MAAM,MAAA,YAAA,GAAe,QAAQ,eAAgB,EAAA;AAC7C,MAAA,IAAI,YAAiB,KAAA,CAAA,EAAW,OAAA,CAAA,eAAA,CAAgB,eAAe,CAAC,CAAA;AAEhE,MAAA,OAAA,CAAQ,MAAM,IAAO,GAAA,MAAA,GAAS,IAAI,CAAE,CAAA,KAAA,CAAM,OAAO,gBAAgB,CAAA;AAAA;AAClE;AACD,EAEgB,QAAA,CAAS,QAAuB,KAAiB,EAAA;AAChE,IAAM,MAAA,gBAAA,GAAmB,MAAM,WAAW,CAAA;AAC1C,IAAI,IAAA,CAAC,KAAM,CAAA,IAAA,IAAQ,gBAAkB,EAAA;AACpC,MAAA,MAAM,UAAU,KAAM,CAAA,OAAA;AAGtB,MAAM,MAAA,YAAA,GAAe,QAAQ,eAAgB,EAAA;AAC7C,MAAA,IAAI,YAAiB,KAAA,CAAA,EAAW,OAAA,CAAA,eAAA,CAAgB,eAAe,CAAC,CAAA;AAEhE,MAAQ,OAAA,CAAA,GAAA,CAAI,KAAM,CAAA,KAAA,EAAO,gBAAgB,CAAA;AACzC,MAAA,KAAA,CAAM,WAAW,CAAI,GAAA,IAAA;AAAA;AACtB;AAEF,CAAA;AA3BqE,MAAA,CAAA,uBAAA,EAAA,wBAAA,CAAA;AAA9D,IAAM,sBAAN,GAAA","file":"ListenerLoaderStrategy.mjs","sourcesContent":["import { LoaderStrategy } from '@sapphire/pieces';\nimport type { Listener } from './Listener';\nimport type { ListenerStore } from './ListenerStore';\n\nexport class ListenerLoaderStrategy extends LoaderStrategy<Listener> {\n\tpublic override onLoad(_store: ListenerStore, piece: Listener) {\n\t\tconst listenerCallback = piece['_listener'];\n\t\tif (listenerCallback) {\n\t\t\tconst emitter = piece.emitter!;\n\n\t\t\t// Increment the maximum amount of listeners by one:\n\t\t\tconst maxListeners = emitter.getMaxListeners();\n\t\t\tif (maxListeners !== 0) emitter.setMaxListeners(maxListeners + 1);\n\n\t\t\temitter[piece.once ? 'once' : 'on'](piece.event, listenerCallback);\n\t\t}\n\t}\n\n\tpublic override onUnload(_store: ListenerStore, piece: Listener) {\n\t\tconst listenerCallback = piece['_listener'];\n\t\tif (!piece.once && listenerCallback) {\n\t\t\tconst emitter = piece.emitter!;\n\n\t\t\t// Increment the maximum amount of listeners by one:\n\t\t\tconst maxListeners = emitter.getMaxListeners();\n\t\t\tif (maxListeners !== 0) emitter.setMaxListeners(maxListeners - 1);\n\n\t\t\temitter.off(piece.event, listenerCallback);\n\t\t\tpiece['_listener'] = null;\n\t\t}\n\t}\n}\n"]}